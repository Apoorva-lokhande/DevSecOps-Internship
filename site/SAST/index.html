
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.2">
    
    
      
        <title>Static Analysis - DevSecOps-pipeline</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6f955dcd.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ef6f36e2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#static-analysis" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="DevSecOps-pipeline" class="md-header__button md-logo" aria-label="DevSecOps-pipeline" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DevSecOps-pipeline
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Static Analysis
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="DevSecOps-pipeline" class="md-nav__button md-logo" aria-label="DevSecOps-pipeline" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    DevSecOps-pipeline
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contents/" class="md-nav__link">
        Contents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Problem-statements" class="md-nav__link">
        Problem Statement
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../setting-up-VM/" class="md-nav__link">
        Setting up VMs
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../setting-up-jenkins/" class="md-nav__link">
        Setting up Jenkins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../setting-up-mkdocs/" class="md-nav__link">
        Setting up mkDocs
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../setting-up-pipeline/" class="md-nav__link">
        Setting up pipeline
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../setting-up-dvna/" class="md-nav__link">
        Setting up DVNA
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Static Analysis
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Static Analysis
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#objective" class="md-nav__link">
    Objective
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-of-pipeline" class="md-nav__link">
    Working of pipeline
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jenkinsfile" class="md-nav__link">
    Jenkinsfile
  </a>
  
    <nav class="md-nav" aria-label="Jenkinsfile">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stages" class="md-nav__link">
    Stages
  </a>
  
    <nav class="md-nav" aria-label="Stages">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization" class="md-nav__link">
    Initialization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build" class="md-nav__link">
    Build
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-and-dynamic-analysis" class="md-nav__link">
    Static and Dynamic Analysis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-dvna-from-jenkins" class="md-nav__link">
    Remove DVNA from Jenkins
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deployment" class="md-nav__link">
    Deployment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#static-application-security-testing" class="md-nav__link">
    Static Application Security Testing
  </a>
  
    <nav class="md-nav" aria-label="Static Application Security Testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sast-tools-for-nodejs-applications" class="md-nav__link">
    SAST Tools for Node.js Applications
  </a>
  
    <nav class="md-nav" aria-label="SAST Tools for Node.js Applications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#njsscan" class="md-nav__link">
    njsscan
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#njsscan-pipeline" class="md-nav__link">
    njsscan pipeline
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auditjs" class="md-nav__link">
    AuditJS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auditjs-pipeline" class="md-nav__link">
    AuditJS pipeline
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sast-pipeline" class="md-nav__link">
    SAST Pipeline
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../software-composition-analysis/" class="md-nav__link">
        Software Composition Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../DAST/" class="md-nav__link">
        Dynamic Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Source-Code-Quality-Analysis/" class="md-nav__link">
        Source Code Quality Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../SBoM/" class="md-nav__link">
        Generating Software Bill of Materials
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Complete-pipeline/" class="md-nav__link">
        Complete Pipeline  Structure
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Resources/" class="md-nav__link">
        Resources
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#objective" class="md-nav__link">
    Objective
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-of-pipeline" class="md-nav__link">
    Working of pipeline
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jenkinsfile" class="md-nav__link">
    Jenkinsfile
  </a>
  
    <nav class="md-nav" aria-label="Jenkinsfile">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stages" class="md-nav__link">
    Stages
  </a>
  
    <nav class="md-nav" aria-label="Stages">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization" class="md-nav__link">
    Initialization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build" class="md-nav__link">
    Build
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-and-dynamic-analysis" class="md-nav__link">
    Static and Dynamic Analysis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-dvna-from-jenkins" class="md-nav__link">
    Remove DVNA from Jenkins
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deployment" class="md-nav__link">
    Deployment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#static-application-security-testing" class="md-nav__link">
    Static Application Security Testing
  </a>
  
    <nav class="md-nav" aria-label="Static Application Security Testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sast-tools-for-nodejs-applications" class="md-nav__link">
    SAST Tools for Node.js Applications
  </a>
  
    <nav class="md-nav" aria-label="SAST Tools for Node.js Applications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#njsscan" class="md-nav__link">
    njsscan
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#njsscan-pipeline" class="md-nav__link">
    njsscan pipeline
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auditjs" class="md-nav__link">
    AuditJS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auditjs-pipeline" class="md-nav__link">
    AuditJS pipeline
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sast-pipeline" class="md-nav__link">
    SAST Pipeline
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="static-analysis">Static Analysis</h1>
<h2 id="objective">Objective</h2>
<p>The aim of this section is to understand the tech stack used for the project (DVNA), identify suitable tools to perform SAST and generate a report to provide a solution to the 6th point of the <a href="https://devsecops-report.netlify.app/problem-statements/">Problem Statement</a>.</p>
<h2 id="working-of-pipeline">Working of pipeline</h2>
<p>To start creating the Jenkins pipeline, login into the jenkin web interface.</p>
<ul>
<li>
<p>In the <code>Dashboard</code>, create a <code>New Item</code> and enter a <code>item name</code>(e.g. <code>dvna-pipeline</code>) and select <code>pipeline</code> and click <code>OK</code>.</p>
</li>
<li>
<p>It was redirected to the <code>configuration</code> page. Here:</p>
<ul>
<li>
<p>Under <code>general</code> section:</p>
</li>
<li>
<p>Gave description of the application being deployed.</p>
</li>
<li>
<p>I checked the <code>Discard old builds</code> as they keep metadata related to old builds.</p>
</li>
<li>
<p>Under <code>pipeline</code> section, I selected the defination dropdown to <code>Pipeline script from SCM</code>.</p>
</li>
<li>
<p>In <code>SCM</code> dropdown I selected <code>Git</code>, and gave the <code>repository URL</code>.</p>
</li>
<li>
<p>Click <code>Save</code> to save and apply the configurations. </p>
</li>
</ul>
</li>
<li>
<p>Go to <code>Dashboard</code> -&gt; <code>dvna-pipeline</code> -&gt; <code>build now</code> -&gt; <code>console output</code>.</p>
</li>
</ul>
<h2 id="jenkinsfile">Jenkinsfile</h2>
<p>Jenkinsfile is a text file that contains the definition of a Jenkins Pipeline and is checked into source control.The following are the contents of the Jenkinsfile which implements a continuous delivery pipeline:</p>
<pre><code>    pipeline {
        agent any

        stages {
            stage ('Initialization') {
                steps {
                    sh 'echo "Starting the build!"'
                }
            }

            stage ('Build') {
                environment {
                    MYSQL_USER="dvna"
                    MYSQL_DATABASE="dvna"
                    MYSQL_PASSWORD=&lt;password&gt;
                    MYSQL_RANDOM_ROOT_PASSWORD=&lt;yes or no&gt;
                    MYSQL_HOST="mysql-db"
                    MYSQL_PORT=3306
                }
                steps {
                    sh 'echo "MYSQL_USER=$MYSQL_USER\nMYSQL_DATABASE=$MYSQL_DATABASE\nMYSQL_PASSWORD=$MYSQL_PASSWORD\nMYSQL_RANDOM_ROOT_PASSWORD=$MYSQL_RANDOM_ROOT_PASSWORD\nMYSQL_HOST=$MYSQL_HOST\nMYSQL_PORT=$MYSQL_PORT" &gt; ~/vars.env'
                    sh 'docker run --rm -d --name dvna-mysql --env-file ~/vars.env mysql:5.7 tail -f /dev/null'
                    sh 'docker run --rm -d --name dvna-app --env-file ~/vars.env --link dvna-mysql:mysql-db -p 9090:9090 appsecco/dvna'
                    sh 'docker cp dvna-app:/app/ ~/'        
                }
            }


            stage ('Remove DVNA from Jenkins') {
                steps {
                    sh 'rm -rf ~/app'
                    sh 'docker stop dvna-app &amp;&amp; docker stop dvna-mysql'
                    sh 'docker rmi appsecco/dvna'
                }
            }

            stage ('Deploy DVNA to Production') {
                steps {
                    sh 'ssh -tt -o StrictHostKeyChecking=no prod-vm@192.168.1.55 "docker stop dvna-app &amp;&amp; docker stop dvna-mysql &amp;&amp; docker rm dvna-app &amp;&amp; docker rm dvna-mysql &amp;&amp; docker rmi appsecco/dvna || true"'
                    sh 'scp ~/vars.env prod-vm@192.168.1.55:~/'
                    sh 'ssh -tt -o StrictHostKeyChecking=no prod-vm@192.168.1.55 "docker run -d --name dvna-mysql --env-file ~/vars.env mysql:5.7 tail -f /dev/null"'
                    sh 'ssh -tt -o StrictHostKeyChecking=no prod-vm@192.168.1.55 "docker run -d --name dvna-app --env-file ~/vars.env --link dvna-mysql:mysql-db -p 8080:8080 appsecco/dvna"'
                }
            }

        }
    }
</code></pre>
<h3 id="stages">Stages</h3>
<p>The pipeline is divided into various stages based on the operations being performed, which are as follows:</p>
<h4 id="initialization">Initialization</h4>
<p>This is the first stage which is used to just display the start of the building stage.</p>
<h4 id="build">Build</h4>
<p>This stage contains the environment variables, in which <code>vars.env</code> file is created and for <code>dvna-mysql</code> container. <code>dvna-app</code> and <code>dvna-mysql</code> containers will run and will be copied into the home directory.</p>
<h4 id="static-and-dynamic-analysis">Static and Dynamic Analysis</h4>
<p>All the stages that follow the Build Stage, except for the last two stages, are for performing static analysis  and dynamic analysis on DVNA and later being stored in a folder <code>reports</code> in <code>jenkins</code> home directory.</p>
<h4 id="remove-dvna-from-jenkins">Remove DVNA from Jenkins</h4>
<p>After the scans are complete, the containers running in Jenkins VM are stopped and removed. Since we're working with a containerized application (DVNA), we need to perform tests on the latest available image on DockerHub. Hence, we remove the existing local <code>appsecco/dvna</code> docker container to avoid running a container with older release of the application image. On the other hand, you don't need to remove the mysql:5.7 container, since we require v5.7 and not the latest version.</p>
<h4 id="deployment">Deployment</h4>
<p>Finally, the satge <code>deploy to dvna</code>, operations are performed on VM over SSH which was configured previously. The two containers, <code>dvna-app</code> and <code>dvna-mysql</code> are run and successfully deployed.</p>
<h2 id="static-application-security-testing">Static Application Security Testing</h2>
<p>SAST is a testing methodology that analyses source code, byte code and binaries for bugs and design errors to find <a href="https://www.synopsys.com/blogs/software-security/types-of-security-vulnerabilities/">security vulnerabilities</a>, before the application is compiled. </p>
<p>SAST does not require a working application and can take place without code being executed. It helps developers identify vulnerabilities in the initial stages of development and quickly resolve issues without breaking builds or passing on vulnerabilities to the final release of the application.</p>
<h3 id="sast-tools-for-nodejs-applications">SAST Tools for Node.js Applications</h3>
<p>As given the name Damn Vulnerable Nodejs Application, it is quite obvious to figure the tech stack used, Nodejs is the server-side language used along with a SQL database.  </p>
<p>The following are the tools used to perform static analysis on Nodejs applications with steps to install and configure them with Jenkins.</p>
<h4 id="njsscan">njsscan</h4>
<p>njsscan is a open source static security code scanner for Node.js applications. Finds insecure patterns in Node.js code and HTML templates.</p>
<p>The tool is written in python, we need to install it using pip3, I went ahead and updated <code>apt package</code> and installed <code>python3-pip</code>.</p>
<pre><code>sudo apt update &amp;&amp; sudo apt install python3-pip
</code></pre>
<p>Intall, njsscan using pip3:</p>
<pre><code>pip3 install njsscan
</code></pre>
<p><strong><em>NOTE</em></strong>: I got an error while installing through njsscan, I entered into the <code>root</code> directory and installed it, which worked for me or you can also create a virtual environment and install it.</p>
<p>I referred the documentation which provides <a href="https://github.com/ajinabraham/njsscan#command-line-options">command line options</a>. Later, I added the script in the jenkinsfile with the following syntax:</p>
<pre><code>mkdir reports
njsscan -o ~/reports/nodejsscan-report.json --json  ./dvna
</code></pre>
<h4 id="njsscan-pipeline">njsscan pipeline</h4>
<p>I added the following stage in the Jenkinsfile to perform the scan, and store the report in JSON format on the Jenkins machine:</p>
<pre><code>stage('NodeJsScan') {
    steps {
        sh 'njsscan --json -o ~/reports/nodejsscan-report ~/app || true'
    }
}
</code></pre>
<p>The complete report generated by NodeJsScan can be found <a href="https://github.com/Apoorva-lokhande/DevSecOps-internship/blob/master/reports/SAST/nodejsscan-report.json">here</a>.</p>
<h4 id="auditjs">AuditJS</h4>
<p>Audits JavaScript is a SAST tool which uses <a href="https://ossindex.sonatype.org/rest">OSS Index v3 REST API</a> to identify known vulnerabilities and outdated package versions.</p>
<ul>
<li>
<p>To install npm and nodejs in dvna container in production server, I followed the commands as given below, the package versions are: <code>npm v6.14.14</code> and <code>nodejs v14.17.4</code>.</p>
<pre><code>sudo apt update
sudo curl -sL https://deb.nodesource.com/setup_14.x | sudo -E bash -
sudo apt install -y nodejs
</code></pre>
</li>
<li>
<p>Install auditjs using npm:</p>
<pre><code>sudo npm install -g auditjs
</code></pre>
</li>
<li>
<p>Scan the directory which holds the files for DVNA and store the scan result in ~/reports/auditjs-report.</p>
<pre><code>auditjs ossi &gt; ~/reports/auditjs-report ./app
</code></pre>
</li>
</ul>
<h4 id="auditjs-pipeline">AuditJS pipeline</h4>
<p>Finally, I added the following stage to the Jenkinsfile to execute the script I wrote:</p>
<pre><code>stage('Auditjs') {
    steps {
        sh 'cd ~/app; auditjs ossi &gt; ~/reports/auditjs-report || true'
    }
}
</code></pre>
<p>The complete report generated by NodeJsScan can be found <a href="https://github.com/Apoorva-lokhande/DevSecOps-internship/blob/master/reports/SAST/auditjs-report.json">here</a>.</p>
<h3 id="sast-pipeline">SAST Pipeline</h3>
<p>Add the following stages to the Jenkinsfile for performing SAST of DVNA:</p>
<pre><code>stage('NodeJsScan') {
    steps {
        sh 'njsscan --json -o ~/reports/nodejsscan-report ~/app || true'
    }
}

stage('Auditjs') {
    steps {
        sh 'cd ~/app; auditjs ossi &gt; ~/reports/auditjs-report || true'
    }
}
</code></pre>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../setting-up-dvna/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Setting up DVNA
            </div>
          </div>
        </a>
      
      
        <a href="../software-composition-analysis/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Software Composition Analysis
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../assets/javascripts/workers/search.fe42c31b.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.4ea5477f.min.js"></script>
      
    
  </body>
</html>